{"version":3,"sources":["webpack:///./src/components/compliance/ComplianceTable.vue","webpack:///src/components/compliance/ComplianceTable.vue","webpack:///./src/components/compliance/ComplianceTable.vue?8fcb","webpack:///./src/components/compliance/ComplianceTable.vue?e2b8"],"names":["_vm","model","value","selectedInsurer","expression","attrs","departments","selectedDept","fileClasses","selectedClass","callback","_c","key","menuMonth","selectedMonth","staticClass","exporting","_v","staticRenderFns","render","name","data","insurers","classificationOptions","mounted","loadInsurers","loadDepartments","watch","newDeptId","loadClassifications","handler","newOptions","map","opt","text","subCode","id","immediate","methods","res","InsDataService","getAll","err","DeptDataService","deptId","axios","get","apiConfig","baseURL","sort","a","b","localeCompare","params","insurerId","fileClass","month","moment","format","url","URLSearchParams","toString","window","open","$emit","message","component"],"mappings":"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","file":"js/chunk-2d0c4fb7.7ffab64e.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{staticClass:\"pa-4\"},[_c('h2',[_vm._v(\"Full Assignment Compliance Ratio Table\")]),_c('v-row',{attrs:{\"dense\":\"\"}},[_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"3\"}},[_c('v-select',{attrs:{\"items\":_vm.insurers,\"item-text\":\"name\",\"item-value\":\"id\",\"label\":\"Insurer\",\"dense\":\"\",\"required\":\"\"},model:{value:(_vm.selectedInsurer),callback:function ($$v) {_vm.selectedInsurer=$$v},expression:\"selectedInsurer\"}})],1),_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"3\"}},[_c('v-select',{attrs:{\"items\":_vm.departments,\"item-text\":\"name\",\"item-value\":\"id\",\"label\":\"Department\",\"dense\":\"\",\"required\":\"\"},model:{value:(_vm.selectedDept),callback:function ($$v) {_vm.selectedDept=$$v},expression:\"selectedDept\"}})],1),_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"3\"}},[_c('v-select',{attrs:{\"items\":_vm.fileClasses,\"label\":\"File Classification\",\"dense\":\"\"},model:{value:(_vm.selectedClass),callback:function ($$v) {_vm.selectedClass=$$v},expression:\"selectedClass\"}})],1),_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"3\"}},[_c('v-menu',{attrs:{\"close-on-content-click\":false},scopedSlots:_vm._u([{key:\"activator\",fn:function({ on, attrs }){return [_c('v-text-field',_vm._g(_vm._b({attrs:{\"label\":\"Month\",\"prepend-icon\":\"mdi-calendar\",\"readonly\":\"\",\"dense\":\"\",\"required\":\"\"},model:{value:(_vm.selectedMonth),callback:function ($$v) {_vm.selectedMonth=$$v},expression:\"selectedMonth\"}},'v-text-field',attrs,false),on))]}}]),model:{value:(_vm.menuMonth),callback:function ($$v) {_vm.menuMonth=$$v},expression:\"menuMonth\"}},[_c('v-date-picker',{attrs:{\"type\":\"month\"},on:{\"change\":function($event){_vm.menuMonth = false}},model:{value:(_vm.selectedMonth),callback:function ($$v) {_vm.selectedMonth=$$v},expression:\"selectedMonth\"}})],1)],1)],1),_c('v-divider',{staticClass:\"my-4\"}),_c('v-btn',{staticClass:\"mt-2\",attrs:{\"color\":\"success\",\"disabled\":!_vm.selectedInsurer || !_vm.selectedDept || !_vm.selectedMonth,\"loading\":_vm.exporting},on:{\"click\":_vm.exportExcel}},[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(\"mdi-file-excel\")]),_vm._v(\" Export Compliance Table \")],1),_c('v-alert',{staticClass:\"mt-4\",attrs:{\"type\":\"info\",\"outlined\":\"\"}},[_vm._v(\" The exported Excel file will contain the full assignment compliance ratio table for your selected filters. \")])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-card class=\"pa-4\">\r\n    <h2>Full Assignment Compliance Ratio Table</h2>\r\n    <v-row dense>\r\n      <v-col cols=\"12\" md=\"3\">\r\n        <v-select\r\n          v-model=\"selectedInsurer\"\r\n          :items=\"insurers\"\r\n          item-text=\"name\"\r\n          item-value=\"id\"\r\n          label=\"Insurer\"\r\n          dense\r\n          required\r\n        />\r\n      </v-col>\r\n      <v-col cols=\"12\" md=\"3\">\r\n        <v-select\r\n          v-model=\"selectedDept\"\r\n          :items=\"departments\"\r\n          item-text=\"name\"\r\n          item-value=\"id\"\r\n          label=\"Department\"\r\n          dense\r\n          required\r\n        />\r\n      </v-col>\r\n      <v-col cols=\"12\" md=\"3\">\r\n        <v-select\r\n          v-model=\"selectedClass\"\r\n          :items=\"fileClasses\"\r\n          label=\"File Classification\"\r\n          dense\r\n        />\r\n      </v-col>\r\n      <v-col cols=\"12\" md=\"3\">\r\n        <v-menu v-model=\"menuMonth\" :close-on-content-click=\"false\">\r\n          <template v-slot:activator=\"{ on, attrs }\">\r\n            <v-text-field\r\n              v-model=\"selectedMonth\"\r\n              label=\"Month\"\r\n              prepend-icon=\"mdi-calendar\"\r\n              readonly\r\n              v-bind=\"attrs\"\r\n              v-on=\"on\"\r\n              dense\r\n              required\r\n            />\r\n          </template>\r\n          <v-date-picker\r\n            v-model=\"selectedMonth\"\r\n            type=\"month\"\r\n            @change=\"menuMonth = false\"\r\n          />\r\n        </v-menu>\r\n      </v-col>\r\n    </v-row>\r\n    <v-divider class=\"my-4\" />\r\n    <v-btn\r\n      color=\"success\"\r\n      class=\"mt-2\"\r\n      :disabled=\"!selectedInsurer || !selectedDept || !selectedMonth\"\r\n      @click=\"exportExcel\"\r\n      :loading=\"exporting\"\r\n    >\r\n      <v-icon left>mdi-file-excel</v-icon>\r\n      Export Compliance Table\r\n    </v-btn>\r\n    <v-alert type=\"info\" outlined class=\"mt-4\">\r\n      The exported Excel file will contain the full assignment compliance ratio\r\n      table for your selected filters.\r\n    </v-alert>\r\n  </v-card>\r\n</template>\r\n<script>\r\nimport moment from \"moment\";\r\nimport axios from \"axios\";\r\nimport { apiConfig } from \"../../config/api.config\";\r\nimport InsDataService from \"../../services/InsDataService\";\r\nimport DeptDataService from \"../../services/DeptDataService\";\r\n\r\nexport default {\r\n  name: \"ComplianceTable\",\r\n  data() {\r\n    return {\r\n      selectedInsurer: null,\r\n      selectedDept: null,\r\n      selectedClass: \"all\",\r\n      selectedMonth: null,\r\n      menuMonth: false,\r\n      insurers: [],\r\n      departments: [],\r\n      fileClasses: [],\r\n      classificationOptions: [],\r\n      exporting: false,\r\n    };\r\n  },\r\n  mounted() {\r\n    this.loadInsurers();\r\n    this.loadDepartments();\r\n  },\r\n  watch: {\r\n    selectedDept(newDeptId) {\r\n      this.loadClassifications(newDeptId);\r\n      this.selectedClass = \"all\";\r\n    },\r\n    classificationOptions: {\r\n      handler(newOptions) {\r\n        // Map classificationOptions to fileClasses for the dropdown\r\n        this.fileClasses = newOptions.map((opt) => ({\r\n          text: opt.subCode || opt.name,\r\n          value: opt.id, // Use id for backend subRefType\r\n        }));\r\n      },\r\n      immediate: true,\r\n    },\r\n  },\r\n  methods: {\r\n    async loadInsurers() {\r\n      try {\r\n        const res = await InsDataService.getAll();\r\n        this.insurers = res.data || [];\r\n      } catch (err) {\r\n        this.insurers = [];\r\n      }\r\n    },\r\n    async loadDepartments() {\r\n      try {\r\n        const res = await DeptDataService.getAll();\r\n        this.departments = res.data || [];\r\n      } catch (err) {\r\n        this.departments = [];\r\n      }\r\n    },\r\n\r\n    async loadClassifications(deptId) {\r\n      if (!deptId || deptId === \"all\") {\r\n        this.classificationOptions = [\r\n          { id: \"all\", subCode: \"All Classifications\" },\r\n        ];\r\n        return;\r\n      }\r\n      const res = await axios.get(\r\n        `${apiConfig.baseURL}/subDepts?deptId=${deptId}`\r\n      );\r\n      this.classificationOptions = [\r\n        { id: \"all\", subCode: \"All Classifications\" },\r\n        ...res.data.sort((a, b) => a.subCode.localeCompare(b.subCode)),\r\n      ];\r\n    },\r\n\r\n    async exportExcel() {\r\n      this.exporting = true;\r\n      try {\r\n        const params = {\r\n          insurerId: this.selectedInsurer,\r\n          deptId: this.selectedDept,\r\n          fileClass: this.selectedClass,\r\n          month: moment(this.selectedMonth).format(\"YYYY-MM\"),\r\n        };\r\n        const url =\r\n          `${apiConfig.baseURL}/compliance/compliance-table/export?` +\r\n          new URLSearchParams(params).toString();\r\n        window.open(url, \"_blank\");\r\n      } catch (err) {\r\n        this.$emit(\"error\", err.message || \"Failed to export Excel\");\r\n      } finally {\r\n        this.exporting = false;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ComplianceTable.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ComplianceTable.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ComplianceTable.vue?vue&type=template&id=078ee498\"\nimport script from \"./ComplianceTable.vue?vue&type=script&lang=js\"\nexport * from \"./ComplianceTable.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}