{"version":3,"sources":["webpack:///./src/components/compliance/ClosedFilesReport.vue","webpack:///src/components/compliance/ClosedFilesReport.vue","webpack:///./src/components/compliance/ClosedFilesReport.vue?f499","webpack:///./src/components/compliance/ClosedFilesReport.vue?f09b"],"names":["_c","attrs","departments","model","value","_vm","callback","expression","selectedClassification","scopedSlots","fn","menuMonth","staticClass","selectedDept","reportData","staticStyle","_v","_s","exportExcel","key","branch","noDataMessage","staticRenderFns","render","name","data","selectedMonth","classificationOptions","totals","below30","above30","above45","above60","above90","total","exporting","computed","reportTitle","_this$departments$fin","deptName","find","d","id","monthStr","moment","format","watch","val","loadClassifications","methods","res","axios","get","apiConfig","baseURL","sort","a","b","localeCompare","deptId","subCode","filter","c","params","classificationId","month","processReportData","Array","isArray","length","_this$departments$fin2","_this$classificationO","className","err","message","url","URLSearchParams","toString","window","open","$emit","mounted","loadDepartments","component"],"mappings":"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","file":"js/chunk-2d0ac1df.f9d2150e.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{staticClass:\"pa-4\"},[_c('h2',[_vm._v(_vm._s(_vm.reportTitle))]),_c('v-row',{attrs:{\"dense\":\"\"}},[_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"3\"}},[_c('v-autocomplete',{attrs:{\"items\":_vm.departments,\"item-text\":\"name\",\"item-value\":\"id\",\"label\":\"Department\",\"dense\":\"\",\"required\":\"\"},model:{value:(_vm.selectedDept),callback:function ($$v) {_vm.selectedDept=$$v},expression:\"selectedDept\"}})],1),_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"3\"}},[_c('v-autocomplete',{attrs:{\"items\":_vm.classificationOptions,\"item-text\":\"subCode\",\"item-value\":\"id\",\"label\":\"File Classification\",\"dense\":\"\",\"disabled\":!_vm.selectedDept,\"clearable\":\"\"},model:{value:(_vm.selectedClassification),callback:function ($$v) {_vm.selectedClassification=$$v},expression:\"selectedClassification\"}})],1),_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"3\"}},[_c('v-menu',{attrs:{\"close-on-content-click\":false},scopedSlots:_vm._u([{key:\"activator\",fn:function({ on, attrs }){return [_c('v-text-field',_vm._g(_vm._b({attrs:{\"label\":\"Month\",\"prepend-icon\":\"mdi-calendar\",\"readonly\":\"\",\"dense\":\"\",\"required\":\"\"},model:{value:(_vm.selectedMonth),callback:function ($$v) {_vm.selectedMonth=$$v},expression:\"selectedMonth\"}},'v-text-field',attrs,false),on))]}}]),model:{value:(_vm.menuMonth),callback:function ($$v) {_vm.menuMonth=$$v},expression:\"menuMonth\"}},[_c('v-date-picker',{attrs:{\"type\":\"month\"},on:{\"change\":function($event){_vm.menuMonth = false}},model:{value:(_vm.selectedMonth),callback:function ($$v) {_vm.selectedMonth=$$v},expression:\"selectedMonth\"}})],1)],1),_c('v-col',{staticClass:\"d-flex align-end\",attrs:{\"cols\":\"12\",\"md\":\"3\"}},[_c('v-btn',{attrs:{\"color\":\"primary\",\"disabled\":!_vm.selectedDept || !_vm.selectedMonth},on:{\"click\":_vm.generateReport}},[_vm._v(\" Generate Report \")])],1)],1),_c('v-divider',{staticClass:\"my-4\"}),(_vm.reportData.length)?_c('div',[_c('div',{staticClass:\"mb-2\"},[_c('div',{staticStyle:{\"background\":\"#92d050\",\"font-family\":\"Tahoma\",\"font-size\":\"1.1rem\",\"font-weight\":\"bold\",\"text-align\":\"center\",\"padding\":\"8px\",\"border-radius\":\"4px\"}},[_vm._v(\" \"+_vm._s(_vm.reportTitle)+\" \")]),_c('div',{staticStyle:{\"background\":\"#ededed\",\"font-family\":\"Tahoma\",\"font-size\":\"0.95rem\",\"text-align\":\"center\",\"padding\":\"6px\",\"border-radius\":\"4px\"}},[_vm._v(\" Closed Files by Branch, \"),_c('span',{staticStyle:{\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(_vm.selectedDept === \"all\" || !_vm.selectedDept ? \"All Departments\" : _vm.departments.find((d) => d.id === _vm.selectedDept)?.name || \"Department\")+\" \")]),_vm._v(\" , \"),_c('span',{staticStyle:{\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(_vm.selectedClassification === \"all\" || !_vm.selectedClassification ? \"All Classifications\" : _vm.classificationOptions.find( (c) => c.id === _vm.selectedClassification )?.subCode || \"Classification\")+\" \")])]),_c('div',{staticStyle:{\"background\":\"#fffbe6\",\"color\":\"#856404\",\"font-family\":\"Tahoma\",\"font-size\":\"0.95rem\",\"text-align\":\"center\",\"padding\":\"6px\",\"border-radius\":\"4px\",\"margin-top\":\"6px\"}},[_vm._v(\" For detailed breakdown by branch and classification, please click \"),_c('strong',[_vm._v(\"Export to Excel\")]),_vm._v(\". \")])]),_c('v-btn',{staticClass:\"mb-4\",attrs:{\"color\":\"success\",\"loading\":_vm.exporting},on:{\"click\":_vm.exportExcel}},[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(\"mdi-file-excel\")]),_vm._v(\" Export to Excel \")],1),_c('v-simple-table',[_c('thead',[_c('tr',{staticStyle:{\"background\":\"#ededed\"}},[_c('th',{staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"13px\",\"font-weight\":\"bold\",\"text-transform\":\"uppercase\",\"text-align\":\"center\",\"border\":\"1px solid #bbb\"}},[_vm._v(\" Branch \")]),_c('th',{staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"13px\",\"font-weight\":\"bold\",\"text-transform\":\"uppercase\",\"text-align\":\"center\",\"border\":\"1px solid #bbb\"}},[_vm._v(\" Below 30 Days \")]),_c('th',{staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"13px\",\"font-weight\":\"bold\",\"text-transform\":\"uppercase\",\"text-align\":\"center\",\"border\":\"1px solid #bbb\"}},[_vm._v(\" Above 30 Days \")]),_c('th',{staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"13px\",\"font-weight\":\"bold\",\"text-transform\":\"uppercase\",\"text-align\":\"center\",\"border\":\"1px solid #bbb\"}},[_vm._v(\" Above 45 Days \")]),_c('th',{staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"13px\",\"font-weight\":\"bold\",\"text-transform\":\"uppercase\",\"text-align\":\"center\",\"border\":\"1px solid #bbb\"}},[_vm._v(\" Above 60 Days \")]),_c('th',{staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"13px\",\"font-weight\":\"bold\",\"text-transform\":\"uppercase\",\"text-align\":\"center\",\"border\":\"1px solid #bbb\"}},[_vm._v(\" Above 90 Days \")]),_c('th',{staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"13px\",\"font-weight\":\"bold\",\"text-transform\":\"uppercase\",\"text-align\":\"center\",\"border\":\"1px solid #bbb\"}},[_vm._v(\" Total \")])])]),_c('tbody',[_vm._l((_vm.reportData),function(row){return _c('tr',{key:row.branch,staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"13px\",\"background\":\"#fff\",\"border\":\"1px solid #bbb\"}},[_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(row.branch))]),_c('td',{staticStyle:{\"text-align\":\"center\",\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(row.below30)+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(row.above30)+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(row.above45)+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(row.above60)+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(row.above90)+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(row.total)+\" \")])])}),_c('tr',{staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"13px\",\"font-weight\":\"bold\",\"background\":\"#ededed\",\"border\":\"1px solid #bbb\"}},[_c('td',{staticStyle:{\"text-align\":\"left\"}},[_c('strong',[_vm._v(\"Total\")])]),_c('td',{staticStyle:{\"text-align\":\"center\"}},[_c('strong',[_vm._v(_vm._s(_vm.totals.below30))])]),_c('td',{staticStyle:{\"text-align\":\"center\"}},[_c('strong',[_vm._v(_vm._s(_vm.totals.above30))])]),_c('td',{staticStyle:{\"text-align\":\"center\"}},[_c('strong',[_vm._v(_vm._s(_vm.totals.above45))])]),_c('td',{staticStyle:{\"text-align\":\"center\"}},[_c('strong',[_vm._v(_vm._s(_vm.totals.above60))])]),_c('td',{staticStyle:{\"text-align\":\"center\"}},[_c('strong',[_vm._v(_vm._s(_vm.totals.above90))])]),_c('td',{staticStyle:{\"text-align\":\"center\"}},[_c('strong',[_vm._v(_vm._s(_vm.totals.total))])])])],2)]),_c('div',{staticClass:\"mt-2\",staticStyle:{\"font-family\":\"Tahoma\",\"font-size\":\"1rem\",\"font-weight\":\"bold\"}},[_vm._v(\" Grand Total: \"+_vm._s(_vm.totals.total)+\" \")])],1):(_vm.noDataMessage)?_c('v-alert',{staticClass:\"mt-4\",attrs:{\"type\":\"warning\",\"outlined\":\"\"}},[_vm._v(\" \"+_vm._s(_vm.noDataMessage)+\" \")]):_c('v-alert',{staticClass:\"mt-4\",attrs:{\"type\":\"info\",\"outlined\":\"\"}},[_vm._v(\" Please select filters and click \\\"Generate Report\\\" to view data. \")])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-card class=\"pa-4\">\r\n    <h2>{{ reportTitle }}</h2>\r\n    <v-row dense>\r\n      <v-col cols=\"12\" md=\"3\">\r\n        <v-autocomplete\r\n          v-model=\"selectedDept\"\r\n          :items=\"departments\"\r\n          item-text=\"name\"\r\n          item-value=\"id\"\r\n          label=\"Department\"\r\n          dense\r\n          required\r\n        />\r\n      </v-col>\r\n      <v-col cols=\"12\" md=\"3\">\r\n        <v-autocomplete\r\n          v-model=\"selectedClassification\"\r\n          :items=\"classificationOptions\"\r\n          item-text=\"subCode\"\r\n          item-value=\"id\"\r\n          label=\"File Classification\"\r\n          dense\r\n          :disabled=\"!selectedDept\"\r\n          clearable\r\n        />\r\n      </v-col>\r\n      <v-col cols=\"12\" md=\"3\">\r\n        <v-menu v-model=\"menuMonth\" :close-on-content-click=\"false\">\r\n          <template v-slot:activator=\"{ on, attrs }\">\r\n            <v-text-field\r\n              v-model=\"selectedMonth\"\r\n              label=\"Month\"\r\n              prepend-icon=\"mdi-calendar\"\r\n              readonly\r\n              v-bind=\"attrs\"\r\n              v-on=\"on\"\r\n              dense\r\n              required\r\n            />\r\n          </template>\r\n          <v-date-picker\r\n            v-model=\"selectedMonth\"\r\n            type=\"month\"\r\n            @change=\"menuMonth = false\"\r\n          />\r\n        </v-menu>\r\n      </v-col>\r\n      <v-col cols=\"12\" md=\"3\" class=\"d-flex align-end\">\r\n        <v-btn\r\n          color=\"primary\"\r\n          @click=\"generateReport\"\r\n          :disabled=\"!selectedDept || !selectedMonth\"\r\n        >\r\n          Generate Report\r\n        </v-btn>\r\n      </v-col>\r\n    </v-row>\r\n    <v-divider class=\"my-4\" />\r\n    <div v-if=\"reportData.length\">\r\n      <!-- Title and subtitle rows -->\r\n      <div class=\"mb-2\">\r\n        <div\r\n          style=\"\r\n            background: #92d050;\r\n            font-family: Tahoma;\r\n            font-size: 1.1rem;\r\n            font-weight: bold;\r\n            text-align: center;\r\n            padding: 8px;\r\n            border-radius: 4px;\r\n          \"\r\n        >\r\n          {{ reportTitle }}\r\n        </div>\r\n        <div\r\n          style=\"\r\n            background: #ededed;\r\n            font-family: Tahoma;\r\n            font-size: 0.95rem;\r\n            text-align: center;\r\n            padding: 6px;\r\n            border-radius: 4px;\r\n          \"\r\n        >\r\n          Closed Files by Branch,\r\n          <span style=\"font-weight: bold\">\r\n            {{\r\n              selectedDept === \"all\" || !selectedDept\r\n                ? \"All Departments\"\r\n                : departments.find((d) => d.id === selectedDept)?.name ||\r\n                  \"Department\"\r\n            }}\r\n          </span>\r\n          ,\r\n          <span style=\"font-weight: bold\">\r\n            {{\r\n              selectedClassification === \"all\" || !selectedClassification\r\n                ? \"All Classifications\"\r\n                : classificationOptions.find(\r\n                    (c) => c.id === selectedClassification\r\n                  )?.subCode || \"Classification\"\r\n            }}\r\n          </span>\r\n        </div>\r\n        <div\r\n          style=\"\r\n            background: #fffbe6;\r\n            color: #856404;\r\n            font-family: Tahoma;\r\n            font-size: 0.95rem;\r\n            text-align: center;\r\n            padding: 6px;\r\n            border-radius: 4px;\r\n            margin-top: 6px;\r\n          \"\r\n        >\r\n          For detailed breakdown by branch and classification, please click\r\n          <strong>Export to Excel</strong>.\r\n        </div>\r\n      </div>\r\n      <v-btn\r\n        color=\"success\"\r\n        class=\"mb-4\"\r\n        @click=\"exportExcel\"\r\n        :loading=\"exporting\"\r\n      >\r\n        <v-icon left>mdi-file-excel</v-icon>\r\n        Export to Excel\r\n      </v-btn>\r\n      <v-simple-table>\r\n        <thead>\r\n          <tr style=\"background: #ededed\">\r\n            <th\r\n              style=\"\r\n                font-family: Tahoma;\r\n                font-size: 13px;\r\n                font-weight: bold;\r\n                text-transform: uppercase;\r\n                text-align: center;\r\n                border: 1px solid #bbb;\r\n              \"\r\n            >\r\n              Branch\r\n            </th>\r\n            <th\r\n              style=\"\r\n                font-family: Tahoma;\r\n                font-size: 13px;\r\n                font-weight: bold;\r\n                text-transform: uppercase;\r\n                text-align: center;\r\n                border: 1px solid #bbb;\r\n              \"\r\n            >\r\n              Below 30 Days\r\n            </th>\r\n            <th\r\n              style=\"\r\n                font-family: Tahoma;\r\n                font-size: 13px;\r\n                font-weight: bold;\r\n                text-transform: uppercase;\r\n                text-align: center;\r\n                border: 1px solid #bbb;\r\n              \"\r\n            >\r\n              Above 30 Days\r\n            </th>\r\n            <th\r\n              style=\"\r\n                font-family: Tahoma;\r\n                font-size: 13px;\r\n                font-weight: bold;\r\n                text-transform: uppercase;\r\n                text-align: center;\r\n                border: 1px solid #bbb;\r\n              \"\r\n            >\r\n              Above 45 Days\r\n            </th>\r\n            <th\r\n              style=\"\r\n                font-family: Tahoma;\r\n                font-size: 13px;\r\n                font-weight: bold;\r\n                text-transform: uppercase;\r\n                text-align: center;\r\n                border: 1px solid #bbb;\r\n              \"\r\n            >\r\n              Above 60 Days\r\n            </th>\r\n            <th\r\n              style=\"\r\n                font-family: Tahoma;\r\n                font-size: 13px;\r\n                font-weight: bold;\r\n                text-transform: uppercase;\r\n                text-align: center;\r\n                border: 1px solid #bbb;\r\n              \"\r\n            >\r\n              Above 90 Days\r\n            </th>\r\n            <th\r\n              style=\"\r\n                font-family: Tahoma;\r\n                font-size: 13px;\r\n                font-weight: bold;\r\n                text-transform: uppercase;\r\n                text-align: center;\r\n                border: 1px solid #bbb;\r\n              \"\r\n            >\r\n              Total\r\n            </th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr\r\n            v-for=\"row in reportData\"\r\n            :key=\"row.branch\"\r\n            style=\"\r\n              font-family: Tahoma;\r\n              font-size: 13px;\r\n              background: #fff;\r\n              border: 1px solid #bbb;\r\n            \"\r\n          >\r\n            <td style=\"text-align: left\">{{ row.branch }}</td>\r\n            <td style=\"text-align: center; font-weight: bold\">\r\n              {{ row.below30 }}\r\n            </td>\r\n            <td style=\"text-align: center; font-weight: bold\">\r\n              {{ row.above30 }}\r\n            </td>\r\n            <td style=\"text-align: center; font-weight: bold\">\r\n              {{ row.above45 }}\r\n            </td>\r\n            <td style=\"text-align: center; font-weight: bold\">\r\n              {{ row.above60 }}\r\n            </td>\r\n            <td style=\"text-align: center; font-weight: bold\">\r\n              {{ row.above90 }}\r\n            </td>\r\n            <td style=\"text-align: center; font-weight: bold\">\r\n              {{ row.total }}\r\n            </td>\r\n          </tr>\r\n          <tr\r\n            style=\"\r\n              font-family: Tahoma;\r\n              font-size: 13px;\r\n              font-weight: bold;\r\n              background: #ededed;\r\n              border: 1px solid #bbb;\r\n            \"\r\n          >\r\n            <td style=\"text-align: left\"><strong>Total</strong></td>\r\n            <td style=\"text-align: center\">\r\n              <strong>{{ totals.below30 }}</strong>\r\n            </td>\r\n            <td style=\"text-align: center\">\r\n              <strong>{{ totals.above30 }}</strong>\r\n            </td>\r\n            <td style=\"text-align: center\">\r\n              <strong>{{ totals.above45 }}</strong>\r\n            </td>\r\n            <td style=\"text-align: center\">\r\n              <strong>{{ totals.above60 }}</strong>\r\n            </td>\r\n            <td style=\"text-align: center\">\r\n              <strong>{{ totals.above90 }}</strong>\r\n            </td>\r\n            <td style=\"text-align: center\">\r\n              <strong>{{ totals.total }}</strong>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </v-simple-table>\r\n      <div\r\n        class=\"mt-2\"\r\n        style=\"font-family: Tahoma; font-size: 1rem; font-weight: bold\"\r\n      >\r\n        Grand Total: {{ totals.total }}\r\n      </div>\r\n    </div>\r\n    <v-alert v-else-if=\"noDataMessage\" type=\"warning\" outlined class=\"mt-4\">\r\n      {{ noDataMessage }}\r\n    </v-alert>\r\n    <v-alert v-else type=\"info\" outlined class=\"mt-4\">\r\n      Please select filters and click \"Generate Report\" to view data.\r\n    </v-alert>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nimport { apiConfig } from \"../../config/api.config\";\r\n\r\nexport default {\r\n  name: \"ClosedFilesReport\",\r\n  data() {\r\n    return {\r\n      selectedDept: null,\r\n      selectedClassification: null,\r\n      selectedMonth: null,\r\n      menuMonth: false,\r\n      departments: [],\r\n      classificationOptions: [],\r\n      reportData: [],\r\n      totals: {\r\n        below30: 0,\r\n        above30: 0,\r\n        above45: 0,\r\n        above60: 0,\r\n        above90: 0,\r\n        total: 0,\r\n      },\r\n      exporting: false,\r\n      noDataMessage: \"\",\r\n    };\r\n  },\r\n  computed: {\r\n    reportTitle() {\r\n      if (!this.selectedDept || !this.selectedMonth)\r\n        return \"Closed Files Report\";\r\n      const deptName =\r\n        this.selectedDept === \"all\"\r\n          ? \"All Departments\"\r\n          : this.departments.find((d) => d.id === this.selectedDept)?.name ||\r\n            \"\";\r\n      const monthStr = moment(this.selectedMonth).format(\"MMMM YYYY\");\r\n      return `${deptName} CLOSED FILES - ${monthStr}`;\r\n    },\r\n  },\r\n  watch: {\r\n    selectedDept(val) {\r\n      this.loadClassifications(val);\r\n    },\r\n  },\r\n  methods: {\r\n    async loadDepartments() {\r\n      const res = await axios.get(`${apiConfig.baseURL}/depts`);\r\n      // Sort departments by name and add \"All Departments\" option\r\n      this.departments = [\r\n        { id: \"all\", name: \"All Departments\" },\r\n        ...res.data.sort((a, b) => a.name.localeCompare(b.name)),\r\n      ];\r\n    },\r\n    async loadClassifications(deptId) {\r\n      if (!deptId || deptId === \"all\") {\r\n        // Only show \"All Classifications\" when no department or \"All Departments\" is selected\r\n        this.classificationOptions = [\r\n          { id: \"all\", subCode: \"All Classifications\" },\r\n        ];\r\n        return;\r\n      }\r\n      // Fetch only classifications relevant to the selected department\r\n      const res = await axios.get(\r\n        `${apiConfig.baseURL}/subDepts?deptId=${deptId}`\r\n      );\r\n      // Sort and set options\r\n      this.classificationOptions = [\r\n        { id: \"all\", subCode: \"All Classifications\" },\r\n        ...res.data\r\n          .filter((c) => c.deptId === deptId) // Ensure only relevant classifications\r\n          .sort((a, b) => a.subCode.localeCompare(b.subCode)),\r\n      ];\r\n    },\r\n    async generateReport() {\r\n      this.reportData = [];\r\n      this.totals = {\r\n        below30: 0,\r\n        above30: 0,\r\n        above45: 0,\r\n        above60: 0,\r\n        above90: 0,\r\n        total: 0,\r\n      };\r\n      this.noDataMessage = \"\";\r\n      try {\r\n        const params = {\r\n          deptId: this.selectedDept === \"all\" ? null : this.selectedDept,\r\n          classificationId:\r\n            this.selectedClassification === \"all\"\r\n              ? null\r\n              : this.selectedClassification,\r\n          month: moment(this.selectedMonth).format(\"YYYY-MM\"),\r\n        };\r\n        const res = await axios.get(\r\n          `${apiConfig.baseURL}/compliance/closed-files`,\r\n          { params }\r\n        );\r\n        this.processReportData(res.data);\r\n        // Show alert if no data\r\n        if (\r\n          !Array.isArray(res.data.reportData) ||\r\n          res.data.reportData.length === 0\r\n        ) {\r\n          const deptName =\r\n            this.departments.find((d) => d.id === this.selectedDept)?.name ||\r\n            \"selected department\";\r\n          const className =\r\n            this.selectedClassification === \"all\"\r\n              ? \"all classifications\"\r\n              : this.classificationOptions.find(\r\n                  (c) => c.id === this.selectedClassification\r\n                )?.subCode || \"selected classification\";\r\n          const monthStr = moment(this.selectedMonth).format(\"MMMM YYYY\");\r\n          this.noDataMessage = `No closed files found for ${deptName} and ${className} in ${monthStr}.`;\r\n        }\r\n      } catch (err) {\r\n        this.noDataMessage =\r\n          err.message || \"Failed to fetch report data. Please try again.\";\r\n      }\r\n    },\r\n    processReportData(data) {\r\n      // Accepts { reportData, totals } from backend\r\n      this.reportData = Array.isArray(data.reportData) ? data.reportData : [];\r\n      this.totals = data.totals || {\r\n        below30: 0,\r\n        above30: 0,\r\n        above45: 0,\r\n        above60: 0,\r\n        above90: 0,\r\n        total: 0,\r\n      };\r\n    },\r\n    async exportExcel() {\r\n      this.exporting = true;\r\n      try {\r\n        const params = {\r\n          deptId: this.selectedDept === \"all\" ? \"\" : this.selectedDept,\r\n          classificationId:\r\n            this.selectedClassification === \"all\"\r\n              ? \"\"\r\n              : this.selectedClassification,\r\n          month: moment(this.selectedMonth).format(\"YYYY-MM\"),\r\n        };\r\n        const url =\r\n          `${apiConfig.baseURL}/compliance/closed-files/export?` +\r\n          new URLSearchParams(params).toString();\r\n        window.open(url, \"_blank\");\r\n      } catch (err) {\r\n        this.$emit(\"error\", err.message || \"Failed to export Excel\");\r\n        // Optionally show a v-alert or toast here\r\n      } finally {\r\n        this.exporting = false;\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.loadDepartments();\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClosedFilesReport.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClosedFilesReport.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ClosedFilesReport.vue?vue&type=template&id=5fe13b76\"\nimport script from \"./ClosedFilesReport.vue?vue&type=script&lang=js\"\nexport * from \"./ClosedFilesReport.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}