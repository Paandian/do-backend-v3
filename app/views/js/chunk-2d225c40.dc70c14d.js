(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d225c40"],{e692:function(e,t,s){"use strict";s.r(t);var n=s("0798"),a=s("8336"),r=s("b0af"),l=s("62ad"),o=s("2e4b"),c=s("ce7e"),i=s("132d"),d=s("e449"),u=s("0fd9"),p=s("b974"),h=s("8654"),m=function(){var e=this,t=e._self._c;return t(r["a"],{staticClass:"pa-4"},[t("h2",[e._v("Ratio Calculator by Closed Files (Insurer)")]),t(u["a"],{attrs:{dense:""}},[t(l["a"],{attrs:{cols:"12",md:"3"}},[t(p["a"],{attrs:{items:e.deptGroupOptions,label:"Department Group",dense:"",outlined:"",required:""},model:{value:e.selectedDeptGroup,callback:function(t){e.selectedDeptGroup=t},expression:"selectedDeptGroup"}})],1),t(l["a"],{attrs:{cols:"12",md:"3"}},[t(p["a"],{attrs:{items:e.insurerOptions,"item-text":"name","item-value":"id",label:"Insurer",dense:"",outlined:"",required:""},model:{value:e.selectedInsurer,callback:function(t){e.selectedInsurer=t},expression:"selectedInsurer"}})],1),t(l["a"],{attrs:{cols:"12",md:"3"}},[t(d["a"],{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:n}){return[t(h["a"],e._g(e._b({attrs:{label:"Month","prepend-icon":"mdi-calendar",readonly:"",dense:"",required:""},model:{value:e.selectedMonth,callback:function(t){e.selectedMonth=t},expression:"selectedMonth"}},"v-text-field",n,!1),s))]}}]),model:{value:e.menuMonth,callback:function(t){e.menuMonth=t},expression:"menuMonth"}},[t(o["a"],{attrs:{type:"month"},on:{change:function(t){e.menuMonth=!1}},model:{value:e.selectedMonth,callback:function(t){e.selectedMonth=t},expression:"selectedMonth"}})],1)],1),t(l["a"],{staticClass:"d-flex align-end",attrs:{cols:"12",md:"3"}},[t(a["a"],{attrs:{color:"success",disabled:!e.selectedDeptGroup||!e.selectedInsurer||!e.selectedMonth},on:{click:e.exportExcel}},[t(i["a"],{attrs:{left:""}},[e._v("mdi-file-excel")]),e._v(" Export Excel ")],1)],1)],1),t(c["a"],{staticClass:"my-4"}),e.alertMessage?t(n["a"],{attrs:{type:"warning",outlined:""}},[e._v(" "+e._s(e.alertMessage)+" ")]):t(n["a"],{attrs:{type:"info",outlined:""}},[e._v(' Select department group, insurer, and month, then click "Export Excel" to generate the report. ')])],1)},f=[],M=(s("e9f5"),s("ab43"),s("c1df")),x=s.n(M),b=s("5632"),v=s("6736"),I={name:"RatioCalculatorInsurer",data(){return{deptGroupOptions:[{value:"TPBI",text:"TPBI"},{value:"MISC",text:"MISC"}],selectedDeptGroup:null,insurerOptions:[],selectedInsurer:null,selectedMonth:null,menuMonth:!1,alertMessage:""}},methods:{async loadInsurers(){try{const e=await b["a"].getAll();this.insurerOptions=e.data.sort((e,t)=>e.name.localeCompare(t.name))}catch{this.insurerOptions=[]}},async exportExcel(){this.alertMessage="";const e={deptGroup:this.selectedDeptGroup,insurerId:this.selectedInsurer,month:x()(this.selectedMonth).format("YYYY-MM")},t=Object.entries(e).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&"),s=`${v["a"].baseURL}/compliance/ratio-calculator-insurer/export?${t}`;try{const e=await fetch(s,{method:"GET"}),t=e.headers.get("content-type");if(t&&t.includes("application/json")){const t=await e.json();if(t.alert)return void(this.alertMessage=t.alert)}window.open(s,"_blank")}catch(n){this.alertMessage=n.message||"Failed to export Excel. Please try again."}}},mounted(){this.loadInsurers()}},g=I,k=s("2877"),y=Object(k["a"])(g,m,f,!1,null,"616638fb",null);t["default"]=y.exports}}]);
//# sourceMappingURL=chunk-2d225c40.dc70c14d.js.map