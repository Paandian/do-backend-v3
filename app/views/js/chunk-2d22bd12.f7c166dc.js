(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22bd12"],{f11b:function(e,t,l){"use strict";l.r(t);var s=l("0798"),a=l("8336"),r=l("b0af"),n=l("62ad"),c=l("2e4b"),o=l("ce7e"),d=l("132d"),i=l("e449"),h=l("0fd9"),m=l("b974"),u=l("8654"),f=function(){var e=this,t=e._self._c;return t(r["a"],{staticClass:"pa-4"},[t("h2",[e._v("Closed Assignments by Clerk (By Month)")]),t(h["a"],{attrs:{dense:""}},[t(n["a"],{attrs:{cols:"12",md:"3"}},[t(m["a"],{attrs:{items:e.roleOptions,label:"User Role",dense:"",required:""},model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}})],1),t(n["a"],{attrs:{cols:"12",md:"3"}},[t(m["a"],{attrs:{items:e.filteredBranches,"item-text":"name","item-value":"id",label:"Branch",dense:"",required:"",disabled:"clerk"===e.selectedRole||"manager"===e.selectedRole||!e.selectedRole},model:{value:e.selectedBranch,callback:function(t){e.selectedBranch=t},expression:"selectedBranch"}})],1),t(n["a"],{attrs:{cols:"12",md:"3"}},[t(m["a"],{attrs:{items:e.filteredClerks,"item-text":"username","item-value":"id",label:"Clerk",dense:"",required:"",disabled:("branchclerk"===e.selectedRole||"branchmanager"===e.selectedRole)&&!e.selectedBranch},model:{value:e.selectedClerk,callback:function(t){e.selectedClerk=t},expression:"selectedClerk"}})],1),t(n["a"],{attrs:{cols:"12",md:"3"}},[t(i["a"],{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:l,attrs:s}){return[t(u["a"],e._g(e._b({attrs:{label:"Month","prepend-icon":"mdi-calendar",readonly:"",dense:"",required:""},model:{value:e.selectedMonth,callback:function(t){e.selectedMonth=t},expression:"selectedMonth"}},"v-text-field",s,!1),l))]}}]),model:{value:e.menuMonth,callback:function(t){e.menuMonth=t},expression:"menuMonth"}},[t(c["a"],{attrs:{type:"month"},on:{change:function(t){e.menuMonth=!1}},model:{value:e.selectedMonth,callback:function(t){e.selectedMonth=t},expression:"selectedMonth"}})],1)],1)],1),t(o["a"],{staticClass:"my-4"}),t(a["a"],{staticClass:"mt-2",attrs:{color:"success",disabled:!e.selectedClerk||!e.selectedMonth,loading:e.exporting},on:{click:e.exportExcel}},[t(d["a"],{attrs:{left:""}},[e._v("mdi-file-excel")]),e._v(" Export Closed Assignments ")],1),t(s["a"],{staticClass:"mt-4",attrs:{type:"info",outlined:""}},[e._v(" The exported Excel file will contain closed assignments by clerk for your selected role and month. ")])],1)},k=[],b=(l("e9f5"),l("910d"),l("f665"),l("a732"),l("88a7"),l("271a"),l("5494"),l("9df5")),p=l("fde1"),C=l("c1df"),x=l.n(C),R=l("6736"),v={name:"ClosedByClerkMonth",data(){return{roleOptions:[{text:"CLERK",value:"clerk"},{text:"MANAGER",value:"manager"},{text:"BRANCHCLERK",value:"branchclerk"},{text:"BRANCHMANAGER",value:"branchmanager"}],selectedRole:null,branches:[],selectedBranch:null,clerks:[],selectedClerk:null,selectedMonth:null,menuMonth:!1,exporting:!1}},computed:{filteredBranches(){return this.selectedRole?"clerk"===this.selectedRole||"manager"===this.selectedRole?[{id:null,name:"ALL BRANCH"}]:this.branches.filter(e=>"HQKL"!==e.name):[]},filteredClerks(){if(!this.selectedRole)return[];if("clerk"===this.selectedRole||"manager"===this.selectedRole)return this.clerks.filter(e=>e.active&&e.roles&&e.roles.some(e=>e.roleCode===this.selectedRole)).sort((e,t)=>e.username.localeCompare(t.username));if(!this.selectedBranch)return[];const e=this.branches.find(e=>e.id===this.selectedBranch);if(!e)return[];const t=e.brCode;return this.clerks.filter(e=>e.active&&e.roles&&e.roles.some(e=>e.roleCode===this.selectedRole)&&Array.isArray(e.branches)&&e.branches.some(e=>e.brCode===t)).sort((e,t)=>e.username.localeCompare(t.username))}},mounted(){this.loadBranches(),this.retrieveClerks()},watch:{selectedRole(e){"branchclerk"!==e&&"branchmanager"!==e||(this.selectedBranch=null),this.selectedClerk=null},selectedBranch(){this.selectedClerk=null}},methods:{async loadBranches(){const e=await p["a"].getAll();this.branches=(e.data||[]).sort((e,t)=>e.name.localeCompare(t.name))},retrieveClerks(){b["a"].getAll().then(e=>{this.clerks=e.data.filter(e=>e.active).sort((e,t)=>e.username.localeCompare(t.username))}).catch(e=>{console.log(e)})},async exportExcel(){this.exporting=!0;try{const e={clerkId:this.selectedClerk,month:x()(this.selectedMonth).format("YYYY-MM")},t=R["a"].baseURL+"/compliance/closed-by-clerk/export?"+new URLSearchParams(e).toString();window.open(t,"_blank")}catch(e){this.$emit("error",e.message||"Failed to export Excel")}finally{this.exporting=!1}}}},g=v,M=l("2877"),B=Object(M["a"])(g,f,k,!1,null,null,null);t["default"]=B.exports}}]);
//# sourceMappingURL=chunk-2d22bd12.f7c166dc.js.map