(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ac1df"],{"17be":function(t,e,a){"use strict";a.r(e);var s=a("0798"),o=a("c6a6"),l=a("8336"),i=a("b0af"),n=a("62ad"),c=a("2e4b"),d=a("ce7e"),r=a("132d"),p=a("e449"),h=a("0fd9"),v=a("1f4f"),f=a("8654"),m=function(){var t=this,e=t._self._c;return e(i["a"],{staticClass:"pa-4"},[e("h2",[t._v(t._s(t.reportTitle))]),e(h["a"],{attrs:{dense:""}},[e(n["a"],{attrs:{cols:"12",md:"3"}},[e(o["a"],{attrs:{items:t.departments,"item-text":"name","item-value":"id",label:"Department",dense:"",required:""},model:{value:t.selectedDept,callback:function(e){t.selectedDept=e},expression:"selectedDept"}})],1),e(n["a"],{attrs:{cols:"12",md:"3"}},[e(o["a"],{attrs:{items:t.classificationOptions,"item-text":"subCode","item-value":"id",label:"File Classification",dense:"",disabled:!t.selectedDept,clearable:""},model:{value:t.selectedClassification,callback:function(e){t.selectedClassification=e},expression:"selectedClassification"}})],1),e(n["a"],{attrs:{cols:"12",md:"3"}},[e(p["a"],{attrs:{"close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:s}){return[e(f["a"],t._g(t._b({attrs:{label:"Month","prepend-icon":"mdi-calendar",readonly:"",dense:"",required:""},model:{value:t.selectedMonth,callback:function(e){t.selectedMonth=e},expression:"selectedMonth"}},"v-text-field",s,!1),a))]}}]),model:{value:t.menuMonth,callback:function(e){t.menuMonth=e},expression:"menuMonth"}},[e(c["a"],{attrs:{type:"month"},on:{change:function(e){t.menuMonth=!1}},model:{value:t.selectedMonth,callback:function(e){t.selectedMonth=e},expression:"selectedMonth"}})],1)],1),e(n["a"],{staticClass:"d-flex align-end",attrs:{cols:"12",md:"3"}},[e(l["a"],{attrs:{color:"primary",disabled:!t.selectedDept||!t.selectedMonth},on:{click:t.generateReport}},[t._v(" Generate Report ")])],1)],1),e(d["a"],{staticClass:"my-4"}),t.reportData.length?e("div",[e(v["a"],[e("thead",[e("tr",[e("th",[t._v("Branch")]),e("th",[t._v("Below 30 Days")]),e("th",[t._v("Above 30 Days")]),e("th",[t._v("Above 45 Days")]),e("th",[t._v("Above 60 Days")]),e("th",[t._v("Above 90 Days")]),e("th",[t._v("Total")])])]),e("tbody",[t._l(t.reportData,(function(a){return e("tr",{key:a.branch},[e("td",[t._v(t._s(a.branch))]),e("td",[t._v(t._s(a.below30))]),e("td",[t._v(t._s(a.above30))]),e("td",[t._v(t._s(a.above45))]),e("td",[t._v(t._s(a.above60))]),e("td",[t._v(t._s(a.above90))]),e("td",[t._v(t._s(a.total))])])})),e("tr",[e("td",[e("strong",[t._v("Total")])]),e("td",[e("strong",[t._v(t._s(t.totals.below30))])]),e("td",[e("strong",[t._v(t._s(t.totals.above30))])]),e("td",[e("strong",[t._v(t._s(t.totals.above45))])]),e("td",[e("strong",[t._v(t._s(t.totals.above60))])]),e("td",[e("strong",[t._v(t._s(t.totals.above90))])]),e("td",[e("strong",[t._v(t._s(t.totals.total))])])])],2)]),e("div",{staticClass:"mt-2"},[e("strong",[t._v("Grand Total: "+t._s(t.totals.total))])]),e(l["a"],{staticClass:"mt-4",attrs:{color:"success",loading:t.exporting},on:{click:t.exportExcel}},[e(r["a"],{attrs:{left:""}},[t._v("mdi-file-excel")]),t._v(" Export to Excel ")],1)],1):t.noDataMessage?e(s["a"],{staticClass:"mt-4",attrs:{type:"warning",outlined:""}},[t._v(" "+t._s(t.noDataMessage)+" ")]):e(s["a"],{staticClass:"mt-4",attrs:{type:"info",outlined:""}},[t._v(' Please select filters and click "Generate Report" to view data. ')])],1)},b=[],u=(a("e9f5"),a("f665"),a("88a7"),a("271a"),a("5494"),a("bc3a")),_=a.n(u),D=a("c1df"),M=a.n(D),g=a("6736"),C={name:"ClosedFilesReport",data(){return{selectedDept:null,selectedClassification:null,selectedMonth:null,menuMonth:!1,departments:[],classificationOptions:[],reportData:[],totals:{below30:0,above30:0,above45:0,above60:0,above90:0,total:0},exporting:!1,noDataMessage:""}},computed:{reportTitle(){var t;if(!this.selectedDept||!this.selectedMonth)return"Closed Files Report";const e="all"===this.selectedDept?"All Departments":(null===(t=this.departments.find(t=>t.id===this.selectedDept))||void 0===t?void 0:t.name)||"",a=M()(this.selectedMonth).format("MMMM YYYY");return`${e} CLOSED FILES - ${a}`}},watch:{selectedDept(t){this.loadClassifications(t)}},methods:{async loadDepartments(){const t=await _.a.get(g["a"].baseURL+"/depts");this.departments=[{id:"all",name:"All Departments"},...t.data.sort((t,e)=>t.name.localeCompare(e.name))]},async loadClassifications(t){if(!t||"all"===t)return void(this.classificationOptions=[{id:"all",subCode:"All Classifications"}]);const e=await _.a.get(`${g["a"].baseURL}/subDepts?deptId=${t}`);this.classificationOptions=[{id:"all",subCode:"All Classifications"},...e.data.sort((t,e)=>t.subCode.localeCompare(e.subCode))]},async generateReport(){this.reportData=[],this.totals={below30:0,above30:0,above45:0,above60:0,above90:0,total:0},this.noDataMessage="";try{const a={deptId:"all"===this.selectedDept?null:this.selectedDept,classificationId:"all"===this.selectedClassification?null:this.selectedClassification,month:M()(this.selectedMonth).format("YYYY-MM")},s=await _.a.get(g["a"].baseURL+"/casefiles/compliance/closed-files",{params:a});if(this.processReportData(s.data),!Array.isArray(s.data.reportData)||0===s.data.reportData.length){var t,e;const a=(null===(t=this.departments.find(t=>t.id===this.selectedDept))||void 0===t?void 0:t.name)||"selected department",s="all"===this.selectedClassification?"all classifications":(null===(e=this.classificationOptions.find(t=>t.id===this.selectedClassification))||void 0===e?void 0:e.subCode)||"selected classification",o=M()(this.selectedMonth).format("MMMM YYYY");this.noDataMessage=`No closed files found for ${a} and ${s} in ${o}.`}}catch(a){this.noDataMessage=a.message||"Failed to fetch report data. Please try again."}},processReportData(t){this.reportData=Array.isArray(t.reportData)?t.reportData:[],this.totals=t.totals||{below30:0,above30:0,above45:0,above60:0,above90:0,total:0}},async exportExcel(){this.exporting=!0;try{const t={deptId:"all"===this.selectedDept?"":this.selectedDept,classificationId:"all"===this.selectedClassification?"":this.selectedClassification,month:M()(this.selectedMonth).format("YYYY-MM")},e=g["a"].baseURL+"/casefiles/compliance/closed-files/export?"+new URLSearchParams(t).toString();window.open(e,"_blank")}catch(t){this.$emit("error",t.message||"Failed to export Excel")}finally{this.exporting=!1}}},mounted(){this.loadDepartments()}},y=C,x=a("2877"),w=Object(x["a"])(y,m,b,!1,null,null,null);e["default"]=w.exports}}]);
//# sourceMappingURL=chunk-2d0ac1df.47f6555f.js.map