(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22bd12"],{f11b:function(e,t,l){"use strict";l.r(t);var s=l("0798"),r=l("8336"),a=l("b0af"),n=l("62ad"),o=l("2e4b"),c=l("ce7e"),d=l("132d"),i=l("e449"),h=l("0fd9"),m=l("b974"),u=l("8654"),k=function(){var e=this,t=e._self._c;return t(a["a"],{staticClass:"pa-4"},[t("h2",[e._v("Closed Assignments by Clerk (By Month)")]),t(h["a"],{attrs:{dense:""}},[t(n["a"],{attrs:{cols:"12",md:"3"}},[t(m["a"],{attrs:{items:e.roleOptions,label:"User Role",dense:"",required:""},model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}})],1),t(n["a"],{attrs:{cols:"12",md:"3"}},[t(m["a"],{attrs:{items:e.filteredBranches,"item-text":"name","item-value":"id",label:"Branch",dense:"",required:"",disabled:"clerk"===e.selectedRole||"manager"===e.selectedRole||!e.selectedRole},model:{value:e.selectedBranch,callback:function(t){e.selectedBranch=t},expression:"selectedBranch"}})],1),t(n["a"],{attrs:{cols:"12",md:"3"}},[t(m["a"],{attrs:{items:e.filteredClerks,"item-text":"username","item-value":"id",label:"Clerk",dense:"",required:"",disabled:("branchclerk"===e.selectedRole||"branchmanager"===e.selectedRole)&&!e.selectedBranch},model:{value:e.selectedClerk,callback:function(t){e.selectedClerk=t},expression:"selectedClerk"}})],1),t(n["a"],{attrs:{cols:"12",md:"3"}},[t(i["a"],{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:l,attrs:s}){return[t(u["a"],e._g(e._b({attrs:{label:"Month","prepend-icon":"mdi-calendar",readonly:"",dense:"",required:""},model:{value:e.selectedMonth,callback:function(t){e.selectedMonth=t},expression:"selectedMonth"}},"v-text-field",s,!1),l))]}}]),model:{value:e.menuMonth,callback:function(t){e.menuMonth=t},expression:"menuMonth"}},[t(o["a"],{attrs:{type:"month"},on:{change:function(t){e.menuMonth=!1}},model:{value:e.selectedMonth,callback:function(t){e.selectedMonth=t},expression:"selectedMonth"}})],1)],1)],1),t(c["a"],{staticClass:"my-4"}),t(r["a"],{staticClass:"mt-2",attrs:{color:"success",disabled:!e.selectedClerk||!e.selectedMonth,loading:e.exporting},on:{click:e.exportExcel}},[t(d["a"],{attrs:{left:""}},[e._v("mdi-file-excel")]),e._v(" Export Closed Assignments ")],1),t(s["a"],{staticClass:"mt-4",attrs:{type:"info",outlined:""}},[e._v(" ðŸš§ This feature generates a styled Excel sheet. Table preview coming soon! ")])],1)},b=[],f=(l("e9f5"),l("910d"),l("f665"),l("a732"),l("88a7"),l("271a"),l("5494"),l("9df5")),C=l("fde1"),p=l("c1df"),x=l.n(p),v=l("6736"),R={name:"ClosedByClerkMonth",data(){return{roleOptions:[{text:"CLERK",value:"clerk"},{text:"MANAGER",value:"manager"},{text:"BRANCHCLERK",value:"branchclerk"},{text:"BRANCHMANAGER",value:"branchmanager"}],selectedRole:null,branches:[],selectedBranch:null,clerks:[],selectedClerk:null,selectedMonth:null,menuMonth:!1,exporting:!1}},computed:{filteredBranches(){return this.selectedRole?"clerk"===this.selectedRole||"manager"===this.selectedRole?this.branches.filter(e=>"HQKL"===e.name):this.branches.filter(e=>"HQKL"!==e.name):[]},filteredClerks(){if(!this.selectedRole)return[];if("clerk"===this.selectedRole||"manager"===this.selectedRole)return this.clerks.filter(e=>e.active&&e.roles&&(e.roles.some(e=>"clerk"===e.roleCode)||e.roles.some(e=>"manager"===e.roleCode))).sort((e,t)=>e.username.localeCompare(t.username));if(!this.selectedBranch)return[];const e=this.branches.find(e=>e.id===this.selectedBranch);if(!e)return[];const t=e.brCode;return this.clerks.filter(e=>e.active&&e.roles&&e.roles.some(e=>e.roleCode===this.selectedRole)&&Array.isArray(e.branches)&&e.branches.some(e=>e.brCode===t)).sort((e,t)=>e.username.localeCompare(t.username))}},mounted(){this.loadBranches(),this.retrieveClerks()},watch:{selectedRole(e){this.selectedBranch=null,this.selectedClerk=null},selectedBranch(){this.selectedClerk=null}},methods:{async loadBranches(){const e=await C["a"].getAll();this.branches=(e.data||[]).sort((e,t)=>e.name.localeCompare(t.name))},retrieveClerks(){f["a"].getAll().then(e=>{this.clerks=e.data.filter(e=>e.roles&&(e.roles.some(e=>"clerk"===e.roleCode)||e.roles.some(e=>"manager"===e.roleCode)||e.roles.some(e=>"branchclerk"===e.roleCode)||e.roles.some(e=>"branchmanager"===e.roleCode))&&e.active).sort((e,t)=>e.username.localeCompare(t.username))}).catch(e=>{console.log(e)})},async exportExcel(){this.exporting=!0;try{const e={clerkId:this.selectedClerk,month:x()(this.selectedMonth).format("YYYY-MM")},t=v["a"].baseURL+"/compliance/closed-by-clerk/export?"+new URLSearchParams(e).toString();window.open(t,"_blank")}catch(e){this.$emit("error",e.message||"Failed to export Excel")}finally{this.exporting=!1}}}},g=R,M=l("2877"),B=Object(M["a"])(g,k,b,!1,null,null,null);t["default"]=B.exports}}]);
//# sourceMappingURL=chunk-2d22bd12.7b225548.js.map