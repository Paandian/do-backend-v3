(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d4397"],{"5fb2":function(e,t,a){"use strict";a.r(t);var l=a("0798"),s=a("8336"),r=a("b0af"),n=a("62ad"),c=a("2e4b"),o=a("ce7e"),d=a("132d"),i=a("e449"),u=a("0fd9"),m=a("b974"),h=a("8654"),k=function(){var e=this,t=e._self._c;return t(r["a"],{staticClass:"pa-4"},[t("h2",[e._v("Closed Assignments by Clerk (By Date)")]),t(u["a"],{attrs:{dense:""}},[t(n["a"],{attrs:{cols:"12",md:"3"}},[t(m["a"],{attrs:{items:e.roleOptions,label:"User Role",dense:"",required:""},model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}})],1),t(n["a"],{attrs:{cols:"12",md:"3"}},[t(m["a"],{attrs:{items:e.filteredBranches,"item-text":"name","item-value":"id",label:"Branch",dense:"",required:"",disabled:"clerk"===e.selectedRole||"manager"===e.selectedRole||!e.selectedRole},model:{value:e.selectedBranch,callback:function(t){e.selectedBranch=t},expression:"selectedBranch"}})],1),t(n["a"],{attrs:{cols:"12",md:"3"}},[t(m["a"],{attrs:{items:e.filteredClerks,"item-text":"username","item-value":"id",label:"Clerk",dense:"",required:"",disabled:("branchclerk"===e.selectedRole||"branchmanager"===e.selectedRole)&&!e.selectedBranch},model:{value:e.selectedClerk,callback:function(t){e.selectedClerk=t},expression:"selectedClerk"}})],1),t(n["a"],{attrs:{cols:"12",md:"3"}},[t(i["a"],{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:l}){return[t(h["a"],e._g(e._b({attrs:{label:"Start Date","prepend-icon":"mdi-calendar",readonly:"",dense:"",required:""},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}},"v-text-field",l,!1),a))]}}]),model:{value:e.menuStart,callback:function(t){e.menuStart=t},expression:"menuStart"}},[t(c["a"],{attrs:{type:"date"},on:{change:function(t){e.menuStart=!1}},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1),t(i["a"],{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:l}){return[t(h["a"],e._g(e._b({attrs:{label:"End Date","prepend-icon":"mdi-calendar",readonly:"",dense:"",required:""},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}},"v-text-field",l,!1),a))]}}]),model:{value:e.menuEnd,callback:function(t){e.menuEnd=t},expression:"menuEnd"}},[t(c["a"],{attrs:{type:"date"},on:{change:function(t){e.menuEnd=!1}},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)],1)],1),t(o["a"],{staticClass:"my-4"}),t(s["a"],{staticClass:"mt-2",attrs:{color:"success",disabled:!e.selectedClerk||!e.startDate||!e.endDate,loading:e.exporting},on:{click:e.exportExcel}},[t(d["a"],{attrs:{left:""}},[e._v("mdi-file-excel")]),e._v(" Export Closed Assignments ")],1),t(l["a"],{staticClass:"mt-4",attrs:{type:"info",outlined:""}},[e._v(" ðŸš§ This feature generates a styled Excel sheet. Table preview coming soon! ")])],1)},f=[],b=(a("e9f5"),a("910d"),a("f665"),a("a732"),a("88a7"),a("271a"),a("5494"),a("9df5")),p=a("fde1"),C=a("6736"),x={name:"ClosedByClerkDate",data(){return{roleOptions:[{text:"CLERK",value:"clerk"},{text:"MANAGER",value:"manager"},{text:"BRANCHCLERK",value:"branchclerk"},{text:"BRANCHMANAGER",value:"branchmanager"}],selectedRole:null,branches:[],selectedBranch:null,clerks:[],selectedClerk:null,startDate:null,endDate:null,menuStart:!1,menuEnd:!1,exporting:!1}},computed:{filteredBranches(){return this.selectedRole?"clerk"===this.selectedRole||"manager"===this.selectedRole?this.branches.filter(e=>"HQKL"===e.name):this.branches.filter(e=>"HQKL"!==e.name):[]},filteredClerks(){if(!this.selectedRole)return[];if("clerk"===this.selectedRole||"manager"===this.selectedRole)return this.clerks.filter(e=>e.active&&e.roles&&(e.roles.some(e=>"clerk"===e.roleCode)||e.roles.some(e=>"manager"===e.roleCode))).sort((e,t)=>e.username.localeCompare(t.username));if(!this.selectedBranch)return[];const e=this.branches.find(e=>e.id===this.selectedBranch);if(!e)return[];const t=e.brCode;return this.clerks.filter(e=>e.active&&e.roles&&e.roles.some(e=>e.roleCode===this.selectedRole)&&Array.isArray(e.branches)&&e.branches.some(e=>e.brCode===t)).sort((e,t)=>e.username.localeCompare(t.username))}},mounted(){this.loadBranches(),this.retrieveClerks()},watch:{selectedRole(e){this.selectedBranch=null,this.selectedClerk=null},selectedBranch(){this.selectedClerk=null}},methods:{async loadBranches(){const e=await p["a"].getAll();this.branches=(e.data||[]).sort((e,t)=>e.name.localeCompare(t.name))},retrieveClerks(){b["a"].getAll().then(e=>{this.clerks=e.data.filter(e=>e.roles&&e.roles.some(e=>"clerk"===e.roleCode||"manager"===e.roleCode||"branchclerk"===e.roleCode||"branchmanager"===e.roleCode)&&e.active).sort((e,t)=>e.username.localeCompare(t.username))}).catch(e=>{console.log(e)})},async exportExcel(){this.exporting=!0;try{const e={clerkId:this.selectedClerk,startDate:this.startDate,endDate:this.endDate},t=C["a"].baseURL+"/compliance/closed-by-clerk/export?"+new URLSearchParams(e).toString();window.open(t,"_blank")}catch(e){this.$emit("error",e.message||"Failed to export Excel")}finally{this.exporting=!1}}}},v=x,g=a("2877"),R=Object(g["a"])(v,k,f,!1,null,null,null);t["default"]=R.exports}}]);
//# sourceMappingURL=chunk-2d0d4397.b5b988a3.js.map